A single embryo, single cell time-resolved model for mouse gastrulation
=======================================================================

This repository contains all the code for reproducing the analysis from the gastrulation flow paper Mittnenzweig et al. (2021). The core analysis is done with the [metacell](https://tanaylab.bitbucket.io/metacell-r/index.html) R package, that also contains the code for generating the network flow model.

## Quick links

- Metacell paper: Baran et al. 2019 [Genome Biol](https://doi.org/10.1186/s13059-019-1812-2)

- Metacell R package

- Raw FASTQ files and processed UMI tables are available under GEO accession [GSE169210](https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE169210)

- The metacell scRNA database for this paper can be downloaded from [here](). 


## Requirements

- metacell package
- lpsymphony
- tidyverse
- pheatmap
- gridExtra
- Matrix
- tidyverse
- shape


## Usage

After cloning the github repository, users should open an R session in the repository root directory and download/initialize the scRNA database (~ 4.7 GB): 
``` r
# Loading code and downloading required data files
source("scripts/init_db.r")

```
The repository root directory should now contain the subfolders *scripts/* containing all the R scripts, *scrna_db* containing the metacell R objects, *config/*, *data/* containing additional data generated by the scripts and *figs/paper_figs/*.

# Regenerating plots for a specific figure
For each figure, (Figure 1-7 and S1-7), there is a corresponding script in *scripts/generate_paper_figures/*. Each script contains a function *gen_fig_xyz_plots()* at the top, that contains further subfunctions and explanations related to the analysis of that figure. E.g., for regenerating the plots of figure 1, users should run the following code:

``` r
# load metacell package
library("metacell")
# initializing the metacell scrna database
scdb_init("scrna_db")

# Generating plots of Figure 1
source("scripts/generate_paper_figures/fig_1.r")
gen_fig_1_plots()

```

### Generating manifold graph and network flow object


### Single-embryo timing


### Network flow parameter stability analysis

### Foxc12 chimera and tetraploid analysis
